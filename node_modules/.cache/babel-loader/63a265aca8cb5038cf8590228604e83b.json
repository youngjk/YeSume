{"ast":null,"code":"/**\n * Copyright 2017 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst {\n  helper,\n  assert\n} = require('./helper');\n\nconst {\n  createJSHandle,\n  JSHandle\n} = require('./JSHandle');\n\nconst EVALUATION_SCRIPT_URL = '__puppeteer_evaluation_script__';\nconst SOURCE_URL_REGEX = /^[\\040\\t]*\\/\\/[@#] sourceURL=\\s*(\\S*?)\\s*$/m;\n\nclass ExecutionContext {\n  /**\n   * @param {!Puppeteer.CDPSession} client\n   * @param {!Protocol.Runtime.ExecutionContextDescription} contextPayload\n   * @param {?Puppeteer.DOMWorld} world\n   */\n  constructor(client, contextPayload, world) {\n    this._client = client;\n    this._world = world;\n    this._contextId = contextPayload.id;\n  }\n  /**\n   * @return {?Puppeteer.Frame}\n   */\n\n\n  frame() {\n    return this._world ? this._world.frame() : null;\n  }\n  /**\n   * @param {Function|string} pageFunction\n   * @param {...*} args\n   * @return {!Promise<(!Object|undefined)>}\n   */\n\n\n  async evaluate(pageFunction, ...args) {\n    const handle = await this.evaluateHandle(pageFunction, ...args);\n    const result = await handle.jsonValue().catch(error => {\n      if (error.message.includes('Object reference chain is too long')) return;\n      if (error.message.includes('Object couldn\\'t be returned by value')) return;\n      throw error;\n    });\n    await handle.dispose();\n    return result;\n  }\n  /**\n   * @param {Function|string} pageFunction\n   * @param {...*} args\n   * @return {!Promise<!JSHandle>}\n   */\n\n\n  async evaluateHandle(pageFunction, ...args) {\n    const suffix = `//# sourceURL=${EVALUATION_SCRIPT_URL}`;\n\n    if (helper.isString(pageFunction)) {\n      const contextId = this._contextId;\n      const expression =\n      /** @type {string} */\n      pageFunction;\n      const expressionWithSourceUrl = SOURCE_URL_REGEX.test(expression) ? expression : expression + '\\n' + suffix;\n      const {\n        exceptionDetails,\n        result: remoteObject\n      } = await this._client.send('Runtime.evaluate', {\n        expression: expressionWithSourceUrl,\n        contextId,\n        returnByValue: false,\n        awaitPromise: true,\n        userGesture: true\n      }).catch(rewriteError);\n      if (exceptionDetails) throw new Error('Evaluation failed: ' + helper.getExceptionMessage(exceptionDetails));\n      return createJSHandle(this, remoteObject);\n    }\n\n    if (typeof pageFunction !== 'function') throw new Error(`Expected to get |string| or |function| as the first argument, but got \"${pageFunction}\" instead.`);\n    let functionText = pageFunction.toString();\n\n    try {\n      new Function('(' + functionText + ')');\n    } catch (e1) {\n      // This means we might have a function shorthand. Try another\n      // time prefixing 'function '.\n      if (functionText.startsWith('async ')) functionText = 'async function ' + functionText.substring('async '.length);else functionText = 'function ' + functionText;\n\n      try {\n        new Function('(' + functionText + ')');\n      } catch (e2) {\n        // We tried hard to serialize, but there's a weird beast here.\n        throw new Error('Passed function is not well-serializable!');\n      }\n    }\n\n    let callFunctionOnPromise;\n\n    try {\n      callFunctionOnPromise = this._client.send('Runtime.callFunctionOn', {\n        functionDeclaration: functionText + '\\n' + suffix + '\\n',\n        executionContextId: this._contextId,\n        arguments: args.map(convertArgument.bind(this)),\n        returnByValue: false,\n        awaitPromise: true,\n        userGesture: true\n      });\n    } catch (err) {\n      if (err instanceof TypeError && err.message === 'Converting circular structure to JSON') err.message += ' Are you passing a nested JSHandle?';\n      throw err;\n    }\n\n    const {\n      exceptionDetails,\n      result: remoteObject\n    } = await callFunctionOnPromise.catch(rewriteError);\n    if (exceptionDetails) throw new Error('Evaluation failed: ' + helper.getExceptionMessage(exceptionDetails));\n    return createJSHandle(this, remoteObject);\n    /**\n     * @param {*} arg\n     * @return {*}\n     * @this {ExecutionContext}\n     */\n\n    function convertArgument(arg) {\n      if (Object.is(arg, -0)) return {\n        unserializableValue: '-0'\n      };\n      if (Object.is(arg, Infinity)) return {\n        unserializableValue: 'Infinity'\n      };\n      if (Object.is(arg, -Infinity)) return {\n        unserializableValue: '-Infinity'\n      };\n      if (Object.is(arg, NaN)) return {\n        unserializableValue: 'NaN'\n      };\n      const objectHandle = arg && arg instanceof JSHandle ? arg : null;\n\n      if (objectHandle) {\n        if (objectHandle._context !== this) throw new Error('JSHandles can be evaluated only in the context they were created!');\n        if (objectHandle._disposed) throw new Error('JSHandle is disposed!');\n        if (objectHandle._remoteObject.unserializableValue) return {\n          unserializableValue: objectHandle._remoteObject.unserializableValue\n        };\n        if (!objectHandle._remoteObject.objectId) return {\n          value: objectHandle._remoteObject.value\n        };\n        return {\n          objectId: objectHandle._remoteObject.objectId\n        };\n      }\n\n      return {\n        value: arg\n      };\n    }\n    /**\n     * @param {!Error} error\n     * @return {!Protocol.Runtime.evaluateReturnValue}\n     */\n\n\n    function rewriteError(error) {\n      if (error.message.endsWith('Cannot find context with specified id')) throw new Error('Execution context was destroyed, most likely because of a navigation.');\n      throw error;\n    }\n  }\n  /**\n   * @param {!JSHandle} prototypeHandle\n   * @return {!Promise<!JSHandle>}\n   */\n\n\n  async queryObjects(prototypeHandle) {\n    assert(!prototypeHandle._disposed, 'Prototype JSHandle is disposed!');\n    assert(prototypeHandle._remoteObject.objectId, 'Prototype JSHandle must not be referencing primitive value');\n    const response = await this._client.send('Runtime.queryObjects', {\n      prototypeObjectId: prototypeHandle._remoteObject.objectId\n    });\n    return createJSHandle(this, response.objects);\n  }\n  /**\n   * @param {Puppeteer.ElementHandle} elementHandle\n   * @return {Promise<Puppeteer.ElementHandle>}\n   */\n\n\n  async _adoptElementHandle(elementHandle) {\n    assert(elementHandle.executionContext() !== this, 'Cannot adopt handle that already belongs to this execution context');\n    assert(this._world, 'Cannot adopt handle without DOMWorld');\n    const nodeInfo = await this._client.send('DOM.describeNode', {\n      objectId: elementHandle._remoteObject.objectId\n    });\n    const {\n      object\n    } = await this._client.send('DOM.resolveNode', {\n      backendNodeId: nodeInfo.node.backendNodeId,\n      executionContextId: this._contextId\n    });\n    return (\n      /** @type {Puppeteer.ElementHandle}*/\n      createJSHandle(this, object)\n    );\n  }\n\n}\n\nmodule.exports = {\n  ExecutionContext,\n  EVALUATION_SCRIPT_URL\n};","map":{"version":3,"sources":["/Users/pro/Desktop/Projects/yesume/node_modules/puppeteer/lib/ExecutionContext.js"],"names":["helper","assert","require","createJSHandle","JSHandle","EVALUATION_SCRIPT_URL","SOURCE_URL_REGEX","ExecutionContext","constructor","client","contextPayload","world","_client","_world","_contextId","id","frame","evaluate","pageFunction","args","handle","evaluateHandle","result","jsonValue","catch","error","message","includes","dispose","suffix","isString","contextId","expression","expressionWithSourceUrl","test","exceptionDetails","remoteObject","send","returnByValue","awaitPromise","userGesture","rewriteError","Error","getExceptionMessage","functionText","toString","Function","e1","startsWith","substring","length","e2","callFunctionOnPromise","functionDeclaration","executionContextId","arguments","map","convertArgument","bind","err","TypeError","arg","Object","is","unserializableValue","Infinity","NaN","objectHandle","_context","_disposed","_remoteObject","objectId","value","endsWith","queryObjects","prototypeHandle","response","prototypeObjectId","objects","_adoptElementHandle","elementHandle","executionContext","nodeInfo","object","backendNodeId","node","module","exports"],"mappings":"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","sourcesContent":["/**\n * Copyright 2017 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst {helper, assert} = require('./helper');\nconst {createJSHandle, JSHandle} = require('./JSHandle');\n\nconst EVALUATION_SCRIPT_URL = '__puppeteer_evaluation_script__';\nconst SOURCE_URL_REGEX = /^[\\040\\t]*\\/\\/[@#] sourceURL=\\s*(\\S*?)\\s*$/m;\n\nclass ExecutionContext {\n  /**\n   * @param {!Puppeteer.CDPSession} client\n   * @param {!Protocol.Runtime.ExecutionContextDescription} contextPayload\n   * @param {?Puppeteer.DOMWorld} world\n   */\n  constructor(client, contextPayload, world) {\n    this._client = client;\n    this._world = world;\n    this._contextId = contextPayload.id;\n  }\n\n  /**\n   * @return {?Puppeteer.Frame}\n   */\n  frame() {\n    return this._world ? this._world.frame() : null;\n  }\n\n  /**\n   * @param {Function|string} pageFunction\n   * @param {...*} args\n   * @return {!Promise<(!Object|undefined)>}\n   */\n  async evaluate(pageFunction, ...args) {\n    const handle = await this.evaluateHandle(pageFunction, ...args);\n    const result = await handle.jsonValue().catch(error => {\n      if (error.message.includes('Object reference chain is too long'))\n        return;\n      if (error.message.includes('Object couldn\\'t be returned by value'))\n        return;\n      throw error;\n    });\n    await handle.dispose();\n    return result;\n  }\n\n  /**\n   * @param {Function|string} pageFunction\n   * @param {...*} args\n   * @return {!Promise<!JSHandle>}\n   */\n  async evaluateHandle(pageFunction, ...args) {\n    const suffix = `//# sourceURL=${EVALUATION_SCRIPT_URL}`;\n\n    if (helper.isString(pageFunction)) {\n      const contextId = this._contextId;\n      const expression = /** @type {string} */ (pageFunction);\n      const expressionWithSourceUrl = SOURCE_URL_REGEX.test(expression) ? expression : expression + '\\n' + suffix;\n      const {exceptionDetails, result: remoteObject} = await this._client.send('Runtime.evaluate', {\n        expression: expressionWithSourceUrl,\n        contextId,\n        returnByValue: false,\n        awaitPromise: true,\n        userGesture: true\n      }).catch(rewriteError);\n      if (exceptionDetails)\n        throw new Error('Evaluation failed: ' + helper.getExceptionMessage(exceptionDetails));\n      return createJSHandle(this, remoteObject);\n    }\n\n    if (typeof pageFunction !== 'function')\n      throw new Error(`Expected to get |string| or |function| as the first argument, but got \"${pageFunction}\" instead.`);\n\n    let functionText = pageFunction.toString();\n    try {\n      new Function('(' + functionText + ')');\n    } catch (e1) {\n      // This means we might have a function shorthand. Try another\n      // time prefixing 'function '.\n      if (functionText.startsWith('async '))\n        functionText = 'async function ' + functionText.substring('async '.length);\n      else\n        functionText = 'function ' + functionText;\n      try {\n        new Function('(' + functionText  + ')');\n      } catch (e2) {\n        // We tried hard to serialize, but there's a weird beast here.\n        throw new Error('Passed function is not well-serializable!');\n      }\n    }\n    let callFunctionOnPromise;\n    try {\n      callFunctionOnPromise = this._client.send('Runtime.callFunctionOn', {\n        functionDeclaration: functionText + '\\n' + suffix + '\\n',\n        executionContextId: this._contextId,\n        arguments: args.map(convertArgument.bind(this)),\n        returnByValue: false,\n        awaitPromise: true,\n        userGesture: true\n      });\n    } catch (err) {\n      if (err instanceof TypeError && err.message === 'Converting circular structure to JSON')\n        err.message += ' Are you passing a nested JSHandle?';\n      throw err;\n    }\n    const { exceptionDetails, result: remoteObject } = await callFunctionOnPromise.catch(rewriteError);\n    if (exceptionDetails)\n      throw new Error('Evaluation failed: ' + helper.getExceptionMessage(exceptionDetails));\n    return createJSHandle(this, remoteObject);\n\n    /**\n     * @param {*} arg\n     * @return {*}\n     * @this {ExecutionContext}\n     */\n    function convertArgument(arg) {\n      if (Object.is(arg, -0))\n        return { unserializableValue: '-0' };\n      if (Object.is(arg, Infinity))\n        return { unserializableValue: 'Infinity' };\n      if (Object.is(arg, -Infinity))\n        return { unserializableValue: '-Infinity' };\n      if (Object.is(arg, NaN))\n        return { unserializableValue: 'NaN' };\n      const objectHandle = arg && (arg instanceof JSHandle) ? arg : null;\n      if (objectHandle) {\n        if (objectHandle._context !== this)\n          throw new Error('JSHandles can be evaluated only in the context they were created!');\n        if (objectHandle._disposed)\n          throw new Error('JSHandle is disposed!');\n        if (objectHandle._remoteObject.unserializableValue)\n          return { unserializableValue: objectHandle._remoteObject.unserializableValue };\n        if (!objectHandle._remoteObject.objectId)\n          return { value: objectHandle._remoteObject.value };\n        return { objectId: objectHandle._remoteObject.objectId };\n      }\n      return { value: arg };\n    }\n\n    /**\n     * @param {!Error} error\n     * @return {!Protocol.Runtime.evaluateReturnValue}\n     */\n    function rewriteError(error) {\n      if (error.message.endsWith('Cannot find context with specified id'))\n        throw new Error('Execution context was destroyed, most likely because of a navigation.');\n      throw error;\n    }\n  }\n\n  /**\n   * @param {!JSHandle} prototypeHandle\n   * @return {!Promise<!JSHandle>}\n   */\n  async queryObjects(prototypeHandle) {\n    assert(!prototypeHandle._disposed, 'Prototype JSHandle is disposed!');\n    assert(prototypeHandle._remoteObject.objectId, 'Prototype JSHandle must not be referencing primitive value');\n    const response = await this._client.send('Runtime.queryObjects', {\n      prototypeObjectId: prototypeHandle._remoteObject.objectId\n    });\n    return createJSHandle(this, response.objects);\n  }\n\n  /**\n   * @param {Puppeteer.ElementHandle} elementHandle\n   * @return {Promise<Puppeteer.ElementHandle>}\n   */\n  async _adoptElementHandle(elementHandle) {\n    assert(elementHandle.executionContext() !== this, 'Cannot adopt handle that already belongs to this execution context');\n    assert(this._world, 'Cannot adopt handle without DOMWorld');\n    const nodeInfo = await this._client.send('DOM.describeNode', {\n      objectId: elementHandle._remoteObject.objectId,\n    });\n    const {object} = await this._client.send('DOM.resolveNode', {\n      backendNodeId: nodeInfo.node.backendNodeId,\n      executionContextId: this._contextId,\n    });\n    return /** @type {Puppeteer.ElementHandle}*/(createJSHandle(this, object));\n  }\n}\n\nmodule.exports = {ExecutionContext, EVALUATION_SCRIPT_URL};\n"]},"metadata":{},"sourceType":"script"}